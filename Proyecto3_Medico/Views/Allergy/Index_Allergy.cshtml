@using Proyecto3_Medico.Models;


<div id="appointment" class="container  ">

    <div class="row justify-content-center align-items-center">
        <div class="col-sm-12 col-md-6 col-lg-6">
            <div class="card h-100">
                <div class="card-body">
                    <form>
                        <h7>Buscar detalles de Alergias</h7>
                        <div>
                            <h7>Paciente: </h7>
                            <select name="paciente" id="paciente" class="form-control">
                                @if (ViewBag.pacientes != null)
                                {
                                    @foreach (patientModel temp in ViewBag.pacientes)
                                    {
                                        <option asp-for="paciente" value="@temp.patient_id">@temp.patient_name  @temp.patient_lastname</option>
                                    }
                                }

                            </select>

                            <input type="button" href="javascript:;" onclick="buscarDetalleAlergia($('#paciente').val()); return false;" id="Buscar" name="Buscar" value="Buscar" class="btn btn-primary" />

                        </div>


                        <div class="table-responsive">
                            <table class="table table-striped" id="detalle">
                                <thead>
                                    <tr>
                                        <th>Nombre Alergia</th>
                                        <th>Fecha Diagnostico</th>
                                        <th>Diagnostico</th>
                                        <th>Medicamentos</th>
                                    </tr>
                                </thead>
                                <tbody id="tbody">
                                </tbody>
                            </table>
                        </div>

                    </form>
                </div>
            </div>
        </div>
        @*ingresar vacuna*@

        <div class="col-sm-12 col-md-6 col-lg-6">
            <div class="card h-100">
                <div class="card-body h-100">
                    <form>
                        <h7>Editar detalle de la Alergia del Paciente</h7>
                        <div>

                            <label>Paciente:</label>
                            <input type="text" class="form-control" id="paciente1" name="paciente1" disabled>
                        </div>
                        <div class="form-group">
                            <label>Alergia a:</label>
                            <input type="text" class="form-control" id="alergia" name="alergia" disabled>
                        </div>
                        <div class="form-group">
                            <label>Fecha de diagnostico</label>
                            <input type="datetime" class="form-control" id="fecha" name="fecha" disabled>
                        </div>

                        <div class="form-group">
                            <label>Diagnostico:</label>
                            <input type="text" class="form-control" id="appDescription" name="appDescription" disabled>
                        </div>

                        <div class="form-group">
                            <label>Medicamentos:</label>
                            <input type="text" class="form-control" id="medicamentos" name="medicamentos" disabled>
                        </div>

                        <div>
                            <input type="button" href="javascript:;" onclick="allowInputAllergy(); return false;" value="EDITAR" />
                            <input type="button" href="javascript:;" onclick="updateAllergy($('#paciente1').val(),$('#alergia').val(),$('#fecha').val(),$('#medicamentos').val(),$('#appDescription').val()); return false;" value="INGRESAR" />
                            <input type="button" href="javascript:;" onclick="deleteAllergy($('#paciente1').val(),$('#alergia').val()); return false;" value="ELIMINAR" />
                        </div>

                    </form>
                </div>
            </div>
        </div>

    </div><!--fin de la fila-->




</div>
<script type="text/javascript">



    $(document).ready(function () {

        $("#detalle tbody").on('click', 'tr', function () {
            // get the current row
            var currentRow = $(this).closest("tr");

            var col1 = $(this).find("td:eq(0)").html();
            var col2 = $(this).find("td:eq(1)").html();
            var col3 = $(this).find("td:eq(2)").html();
            var col4 = $(this).find("td:eq(3)").html();

            document.getElementById("paciente1").value = $("#paciente").val();
            document.getElementById("alergia").value = col1;
            document.getElementById("fecha").value = col2;
            document.getElementById("appDescription").value = col3;
            document.getElementById("medicamentos").value = col4;

        });

    });
</script>